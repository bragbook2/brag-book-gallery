=== BRAGBook Gallery Changelog ===

= 3.3.2-beta14 (2025-11-13) =

Enhanced:
* Search Input Accessibility - Improved search input ARIA attributes for better screen reader support
  - Added role="combobox" to mobile search input for proper accessibility
  - Standardized class names across mobile and desktop search inputs
  - Enhanced ARIA labels and autocomplete attributes
  - Updated in includes/shortcodes/class-gallery-handler.php
* HTML Semantics - Improved semantic HTML structure
  - Changed non-heading titles from h4 to p tags where appropriate
  - Updated Gallery Checker page status title (includes/admin/debug/class-gallery-checker.php)
  - Updated nudity warning title (src/js/modules/filter-system.js)
* Chart Colors - Updated consultation chart colors in Communications page
  - Changed chart border and background colors from #D94540 to #CC0000
  - Updated in includes/admin/pages/class-communications-page.php

= 3.3.2-beta13 (2025-11-12) =

Added:
* Minified Assets - Implemented intelligent asset minification system
  - Production mode loads .min.js and .min.css files for optimal performance
  - Development mode (SCRIPT_DEBUG enabled) loads non-minified versions for debugging
  - Webpack generates both minified and non-minified JavaScript files
  - Sass generates both compressed and expanded CSS files
  - File size reductions: JS 50-54%, CSS 10-13%
  - Updated Asset_Manager, Assets, and Sync_Page classes to use suffix-based loading
* Procedure Links - Added clickable links to procedures in case card details
  - Each procedure in "Procedures Performed" list now links to its taxonomy page
  - Includes hover animations and accessibility improvements
  - Added brag-book-gallery-case-card-procedures-list__link CSS class
  - Enhanced user navigation to related cases by procedure

Fixed:
* Sitemap Generation - Fixed critical TypeError in Sitemap class
  - Resolved "Return value must be of type string, null returned" error
  - Fixed undefined variable references when Cache_Manager was removed
  - Updated get_sitemap_content(), generate_sitemap(), is_rate_limited(), and get_cached_data()
  - All variables now properly initialized before use

= 3.3.2-beta9 (2025-11-07) =

Fixed:
* Stage 3 Sync Title Assignment - Fixed issue where case post titles were being overwritten with incorrect procedure names
  - Moved taxonomy assignment to occur before save_api_response_data() call
  - Ensures correct procedure term is available when title is regenerated
  - Previously, cases from different procedures could all show the same procedure name
  - Fixed in includes/sync/class-chunked-data-sync.php

Enhanced:
* V3 Card Image Clickability - Added anchor link around images in v3 card type
  - Images in v3 cards are now fully clickable and link to case detail page
  - Previously only the arrow button in the overlay was clickable
  - V2 cards remain unchanged (arrow-only clickability)
  - Enhanced in includes/shortcodes/class-cases-handler.php

= 3.3.2-beta8 (2025-11-06) =

Fixed:
* General Bug Fixes - Various bug fixes and stability improvements
* Case Details - Enhanced case details display and functionality
* Titles - Improved title handling and display
* Sync Updates - Updated synchronization functionality and reliability

= 3.3.2-beta5 (2025-10-20) =

Added:
* Alternative Favorites View - New tiles layout option for MyFavorites page
  - Added MyFavorites View Type setting in Display Settings (default/alternative options)
  - Alternative view features horizontal filter bar without sidebar navigation
  - Provides consistent user experience with other tiles views (procedure tiles, case alternative)
  - Setting: brag_book_gallery_favorites_view with options 'default' and 'alternative'

Fixed:
* Favorites Empty State Logic - Corrected JavaScript display conditions for empty favorites state
  - Empty state now only shows when user has verified email but no saved favorites
  - Previously showed email capture form inappropriately when user had no favorites
  - Fixed initializeDedicatedFavoritesPage() and showEmptyFavoritesState() methods
* Infinite Loop Prevention - Resolved circular call between Gallery_Handler and Favorites_Handler
  - Added setting check before delegation to prevent recursive rendering
  - Gallery_Handler now checks brag_book_gallery_favorites_view before delegating to Favorites_Handler
  - Ensures proper routing for both default (sidebar) and alternative (tiles) views

Enhanced:
* Method Visibility - Made render_tiles_filter_bar() and render_full_gallery() public for better reusability
* Wrapper Standardization - Updated favorites views to use standard brag-book-gallery-wrapper class

= 3.3.2-beta2 (2025-10-09) =

Fixed:
* Landing Page Text Editor - Replaced TinyMCE with Trumbowyg WYSIWYG editor to resolve AMD/RequireJS conflicts
  - Removed problematic WordPress TinyMCE editor that conflicted with Monaco Editor
  - Implemented lightweight Trumbowyg editor with visual and HTML editing modes
  - Fixed "Can only have one anonymous define call per script file" error
  - Vanilla ES6 JavaScript implementation for better performance
  - Toolbar includes formatting, bold, italic, links, lists, and HTML view toggle
* Gallery Landing Page Error - Fixed null reference error in procedure referrer tracking
  - Added null check in global-utilities.js before accessing regex match results
  - Resolved "Cannot read properties of null (reading '1')" JavaScript error
  - Error only occurred when visiting gallery landing page (non-procedure pages)

= 3.3.2-beta1 (2025-10-09) =

Added:
* Initial beta release for testing multi-channel release system

= 3.3.1 (2025-10-08) =

Added:
* Column View - New shortcode view for displaying procedures organized by parent categories
  - Adaptive grid layout automatically adjusts columns based on number of parent categories (1-5 columns)
  - Responsive breakpoints for mobile, tablet, and desktop displays
  - Usage: [brag_book_gallery view="column"]
* Procedure Banner Images - Support for banner images on procedure parent categories
  - Retrieves banner images from banner_image term meta
  - Implements responsive <picture> elements with multiple image sizes
  - Includes lazy loading and async decoding for performance
  - Automatic fallback to parent category name for alt text
* Multi-Channel Release System - Beta, RC, and stable release channels
  - Users can opt into beta or RC releases for early access to new features
  - Channel selection available in General Settings
  - Automatic filtering of GitHub releases based on selected channel
  - Enhanced update notification system with channel-specific warnings

Fixed:
* Asset Versioning - Updated Asset_Manager VERSION constant to match plugin version
* Column View Assets - Added missing asset enqueuing in handle_column_view() method

= 3.3.0 (2025-10-07) =

Added:
* Automatic Sync Cron Jobs - Full implementation of WordPress cron-based automatic synchronization
  - Added weekly cron schedule support to WordPress (not included by default)
  - Implemented custom date/time scheduling for one-time sync events
  - Created visual cron status display on Sync Settings page showing next scheduled sync
  - Added "Test Cron Now" button for manual cron job testing and validation
  - Full 3-stage sync execution via cron (Procedures, Manifest, Cases)
  - Detailed logging for all cron operations for debugging
  - Automatic schedule clearing when sync is disabled
* Cron Status Monitoring - Real-time visibility of scheduled sync operations
  - Shows exact date/time of next scheduled sync
  - Displays human-readable countdown (e.g., "In 6 days")
  - Indicates overdue syncs when cron hasn't executed on schedule
  - Integrated status display directly in admin interface

Fixed:
* Nudity Warnings on Case Cards - Fixed nudity warnings not appearing on individual case cards for procedures with nudity flags
  - Added missing nudity warning rendering logic to render_wordpress_case_card() method in Cases_Handler class
  - Fixed inconsistent nudity detection by using WordPress taxonomy meta instead of API sidebar data
  - Unified nudity detection approach across gallery and sidebar handlers for consistency
* Favorites Display - Enhanced favorites functionality with user information display
  - Added user email and favorites count display after content title on favorites page
  - Updated card HTML structure to match exact design specifications
  - Improved favorites grid rendering with proper user info integration
* Procedure Taxonomy Pages - Prevented unwanted API calls on procedure taxonomy pages
  - Fixed is_bragbook_page() method in Assets class to exclude procedure taxonomy pages
  - Added explicit check using is_tax('procedures') to prevent frontend assets from loading
  - Resolves issue where sidebar and cases API endpoints were being called unnecessarily
* Carousel Cross-Origin Images - Fixed Firefox cookie rejection errors for Cloudflare-protected images from BRAGBook API
  - Added crossorigin="anonymous" attributes to all external image elements in JavaScript modules
  - Prevents Firefox from rejecting Cloudflare __cf_bm cookies when loading before/after images
  - Affected files: filter-system.js, global-utilities.js, main-app.js, carousel.js
* JavaScript Build Errors - Fixed syntax errors in main-app.js caused by console statement cleanup
  - Removed orphaned object literals left after automated console.log removal
  - Fixed broken JavaScript that was preventing webpack builds from completing

Enhanced:
* Sync Status Display - Enhanced file-based sync status to show comprehensive data equivalent to previous database system
  - Updated parse_log_file_for_status() method to extract detailed procedure and case counts from log files
  - Added warning detection for duplicate case IDs and other sync warnings
  - Implemented accurate counting of procedures and cases created by parsing log entries
  - Enhanced duration formatting to match previous MM:SS display format
  - Updated sync status display to show warnings, duplicate counts, and comprehensive statistics
  - Maintains full data compatibility with previous sync status information
* Performance Improvements - Increased default posts per page from 10 to 200 for better user experience
  - Updated brag_book_gallery_items_per_page option default value across all relevant handlers
  - Reduces need for pagination and improves gallery browsing experience
* Card Structure - Updated JavaScript-generated favorite cards to match exact HTML structure
  - Ensured consistency between server-rendered and client-rendered case cards
  - Improved responsive design and styling consistency
* Code Quality - Removed all development console.log statements from JavaScript modules
  - Cleaned up debugging code from all frontend JavaScript files for production
  - Improved code maintainability and reduced bundle size
* Carousel Simplification - Removed GSAP dependency and autoplay functionality from carousel
  - Simplified carousel implementation to use only native browser APIs
  - Removed complex animation library dependencies for better cross-browser compatibility
  - Eliminated autoplay and auto-scroll options as requested

= 3.2.8 (2025-09-11) =

Added:
* Delete All Rewrite Rules - New functionality in Flush Rules debug tool to completely remove all rewrite rules
  - Aggressive deletion mechanism with multiple methods to ensure complete removal
  - Direct database deletion using SQL queries
  - Temporary blocking of WordPress rule regeneration (60 seconds)
  - Confirmation count showing exactly how many rules were deleted
  - Detailed logging of deletion operations

Fixed:
* Rewrite Rules Detection - Fixed gallery rules detection in flush rules tool
  - Updated to detect modern query variables (brag_book_gallery_view, brag_gallery_slug, etc.)
  - Fixed issue where gallery rules were showing as 0 when they actually existed
  - Added support for both legacy and current query variable patterns
* Verify Rules Function - Enhanced to check database directly without triggering regeneration
  - Uses direct SQL query to check if rules exist
  - Shows clear success message when rules are deleted
  - Prevents WordPress from auto-regenerating rules during verification

Improved:
* Rewrite Flush Tool - Enhanced user interface and feedback
  - Added "Danger Zone" section for destructive operations
  - Double confirmation required for delete all rules operation
  - Shows deletion history with exact counts (total and gallery-specific)
  - Better error handling with detailed error messages
  - Visual status indicators for rule presence/absence

= 3.2.7 (2025-09-11) =

Added:
* Dual Caching System - Implemented comprehensive dual caching strategy for optimal performance
  - All data types (sidebar, cases, individual case, carousel) now use both WP Engine object cache AND transients
  - Automatic fallback mechanism ensures data persistence across cache flushes
  - Intelligent cache retrieval checks object cache first (faster), falls back to transients if needed
* Legacy Transient Cleanup - Added dedicated cleanup functionality for old transient patterns
  - New "Clear Legacy Transients" button in Cache Management debug tool
  - Removes obsolete transient patterns from previous plugin versions
  - Automatic detection and cleanup of orphaned cache entries

Fixed:
* Cache Management Tool - Resolved critical issues with cache viewing and management
  - Fixed double-prefixing issue preventing cache data from being viewed
  - Updated queries to detect both old and new transient naming patterns
  - Corrected delete operations to handle various key formats
  - Fixed clear_all_cache() method that was returning static message instead of clearing cache
* Cache Helper Functions - Enhanced to provide true dual caching
  - brag_book_set_cache() now stores in BOTH wp_cache and transients
  - brag_book_get_cache() checks wp_cache first, falls back to transients
  - brag_book_delete_cache() removes from BOTH cache layers
* Case Details API - Fixed POST method with JSON body
  - Changed from GET with query params to POST with JSON body
  - Wrapped parameters in 'items' object as expected by API
  - Applied cache-first approach for better performance

Improved:
* Cache Query Performance - Optimized database queries for cache management
  - Updated SQL queries to search for multiple transient patterns efficiently
  - Improved pagination for large cache datasets
  - Enhanced cache statistics calculation
* Cache Management UI - Better display and organization
  - Simplified cache type categories (sidebar, cases, case, carousel, misc)
  - Nice name formatting for cache keys
  - Better visual organization of cache items
* URL Routing - Better WP Engine compatibility
  - Implemented rewrite_rules_array filter for URL routing
  - Added fallback URL parsing for WP Engine environments
  - Enhanced query vars registration

= 3.2.6 (2025-09-11) =

Fixed:
* Cache Management Debug Tools - Enhanced cache view functionality with comprehensive diagnostic logging
  - Added detailed debug logging for cache management view operations
  - Implemented database validation checks for transient cache items
  - Added expiration timestamp validation for cache debugging
  - Improved error reporting for cache retrieval issues

= 3.2.5 (2025-09-11) =

Added:
* WP Engine Diagnostics Tool - Comprehensive diagnostic system specifically designed for WP Engine hosting environments
  - Environment detection and compatibility checking for WP Engine servers
  - Rewrite rules testing and validation with URL pattern matching
  - Query variable registration verification and debugging
  - Object cache status monitoring and performance metrics
  - API endpoint connectivity testing with detailed response analysis
  - Cache mechanism validation for both object and transient caches
  - Hosting-specific optimizations and recommendations
* Enhanced URL Routing - Improved compatibility with WP Engine's infrastructure
  - Implemented fallback URL parsing for environments with restricted rewrite capabilities
  - Added comprehensive query variable registration with validation
  - Enhanced parse_request handling for custom gallery routes
  - Improved handling of myfavorites and case detail pages
  - Better support for pagination and filtering parameters

Fixed:
* WP Engine URL Routing - Resolved issues specific to WP Engine hosting
  - Fixed custom rewrite rules not being recognized on WP Engine
  - Corrected query variable registration timing issues
  - Resolved conflicts with WP Engine's caching layer
  - Fixed 404 errors on gallery pages in WP Engine environments
* Case Details Loading - Improved reliability on cached environments
  - Enhanced case detail API calls for better cache compatibility
  - Fixed case loading issues when object cache is enabled
  - Improved error handling for API timeouts

= 3.2.4 (2025-09-10) =

Fixed:
* Case Details Modal - Fixed responsive display issues on mobile devices
* API Error Handling - Improved error messages for better debugging

= 3.2.3 (2025-09-10) =

Added:
* Debug Tools - New suite of debugging utilities
* System Info Export - Export system configuration for support

Fixed:
* JavaScript Loading - Resolved conflicts with other plugins
* Gallery Filtering - Fixed issue with multiple filter selections

= 3.2.2 (2025-09-09) =

Improved:
* Performance - Optimized database queries for faster page loads
* Caching - Enhanced cache management for better performance

= 3.2.1 (2025-09-09) =

Fixed:
* Installation - Resolved activation issues on certain hosting environments
* Compatibility - Fixed PHP 8.2 compatibility warnings

= 3.2.0 (2025-09-08) =

Added:
* Major UI Overhaul - Completely redesigned admin interface
* Advanced Debug Tools - Comprehensive debugging suite
* Improved Performance - Significant speed improvements

For complete version history, see CHANGELOG.md